---
title: "Assignment 1"
author: "Jon Isaacson"
date: "10/1/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Part I Theory

## Problem 1
### Question
Let $X$ follow a binomial distribution with number of trials $n = 10$ and probability of success in each trial $\theta = 0.3$. Write an algorithm that requires only *one standard uniform random variable* to simulate one observation from the distribution of $X$ so that the efficiency for use of uniform random variables in simulating $X$ is 1:1.

### Solution

1. Determine the quantity to simulate 
2. Simulate $u \sim U(0,1)$
3. 

``` {r }
u<-runif(1000)
x<-qbinom(u, 10, 0.3)
table(x)
hist(x, probability = T)

```

## Problem 2



## Problem 3
### Question

### Solution



## Problem 4
### Question
### Solution

## Problem 5
### Question
### Solution

# Part II Practice

## Problem 6
For purposes of this problem you can use built-in random variable generating functions in R. For example, you can use rnorm to simulate normal random variables. In this problem we will computationally verify that in the context of linear regression we can obtain the Ordinary Least Squares estimates for the regression coefficients using a matrix decomposition method. We let
$$y_i=\beta_0+\beta_1x_{1i}+\beta_2x_{2i}+\epsilon_i,~~~i=1,2,...,n$$
where $y_i$ is the ith response at the ith predictor variables for $x_1$ and $x_2$ and $\epsilon_i$ are errors satisfying the Gauss-Markov conditions,
* $E(\epsilon_i)=0$, $Var(\epsilon_i}=0$, $\forall i$
* $Cov(\epsilon_i,\epsilon_j)$ $\forall (i,j)$

### Question A
Build a linear regression model and simulate a data set to work on. Let $n = 100,~\beta_1 = 3,~\beta_2 = 2$. In a classical linear regression model, the predictors $x_{1i}$ and $x_{2i}$ are fixed and for convenience we will fix these values by simulating them from $Unif(0 10)$ independently, and also simulate $\epsilon_i\sim Nor(\mu=0,\sigma=0.5)$ for $i=1,2,...,n $ Given values of predictors, regression coefficients, and errors, calculate the values of response variable $y_i$. We have simulated a data set from a linear regression model and know the true model since we set the values of parameters.

### Solution A
```{r}
set.seed(123)
source(file = "Function - Uniform Random Data Generator.R")
data<-unif.datagenerator(100, 2, 0, 10)
data.df<-data.frame(data)
data.df$Epsilon<-rnorm(100, 0, 0.5)
data.df$Y<-data.df$X1*3+data.df$X2*2+data.df$Epsilon
head(data.df)
```

### Problem B
Run `lm` function in R (see `?lm` in R) to perform a linear regression analysis (predictors $x_1, x_2$ and response $y$) and record $\hat\beta$ estimates from the R output.

### Solution B
```{r}
l.model<-lm(data=data, Y~X1+X2)
l.model$coefficients
```

### Question C
Write an R function that takes this data set as input and outputs $\hat\beta$ using svd function in R for Singular Value Decomposition.

### Solution C
```{r}
svd.lm.coefficients<-function(data){}
```

### Question D
Compare estimates $\hat\beta$ from part (b) and (c).

### Solution D

## Problem 7
*Urn models* are probabilistic models that are basis for many real life discrete stochastic models. An urn model formulates a discrete data generating mechanism using various well-defined sampling schemes of balls from an urn.
  Consider the following urn model: There are $\alpha_W$ white balls, $\alpha_R$ red balls, and $\alpha_B$ blue balls in a well-mixed urn and no other balls. Draw a ball by simple random sampling. Observe its color and put it back to the urn together with another (new) ball of the same color. For example, if a red ball is drawn, then return that ball and an additional red ball to the urn before the second draw. Continue sampling this way and stop when n draws are made. This urn scheme is known as multivariate Pólya urn (basic Pólya urn has only two colored balls).
  We are interested in finding a method to simulate the random variable that captures
the number of balls of each color in n draws. For example if $n = 10$, a
realization of the random variable could be $(n_W = 4; n_R = 0; n_B = 6)$, $(n = n_W + n_R + n_B)$ Note that we can simulate this process directly by sampling balls
from an urn as described. However, this would be computationally inefficient if $n$
is large, we want to simulate samples for a number of $\alpha = (\alpha_W; \alpha_R; \alpha_B)$ vectors, or even generalize the model to non integer $\alpha$ (see part (b) below). An easier way is to find probability distributions associated with the described stochastic process and sample those distributions. 

### Question A
Write an R function that takes arguments as $(\alpha_W, \alpha_R, \alpha_B), n$, and returns a sample from this urn model using the random variable generation methods that we learned in class and any extrensions you can devise. As an example to illustrate that your program works use $ \alpha = (\alpha_W = 1, \alpha_R = 5 \alpha_B = 2)$ and $n = 100$.

### Solution A
```{r}

```

### Question B
Generalize your function to a model with $k$ types of balls, where the input is
a vector $\alpha = (\alpha_1, \alpha_2,..., \alpha_k)$ (and $n$), where $\alpha_i \in \mathbb{R}$; which means that $\alpha_i > 0$ does not need to be integer.

### Solution B